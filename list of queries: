
most_attended_competitions_in_single_month: 
SELECT
    attended_within_month,
    '[' || person.name || '](https://www.worldcubeassociation.org/persons/' || person.id || ')' AS person_link,
    month_name,
    competitions_year,
    competition_links
FROM (
    SELECT
        COUNT(*) AS attended_within_month,
        personId,
        TO_CHAR(TO_DATE(year || '-' || month || '-01', 'YYYY-MM-DD'), 'Month') AS month_name,
        year AS competitions_year,
        LISTAGG(
            '[' || competition.cellName || '](https://www.worldcubeassociation.org/competitions/' || competition.id || ')',
            ', '
        ) WITHIN GROUP (ORDER BY year, month, day) AS competition_links
    FROM (
        SELECT DISTINCT competitionId, personId
        FROM Results
    ) results
    JOIN Competitions competition 
        ON competition.id = results.competitionId
    GROUP BY personId, year, month
    HAVING COUNT(*) >= 4
) comps_within_single_month_by_person
JOIN Persons person 
    ON person.id = comps_within_single_month_by_person.personId 
    AND person.subId = 1
ORDER BY attended_within_month DESC, person.name;

most_attended_competitions_in_single_week
